(function(){
function toNumber(v){if(typeof v==="number")return v;var c=String(v||"").replace(/,/g,"").trim();var n=parseFloat(c);return Number.isFinite(n)?n:0;}
function formatINR(v){return new Intl.NumberFormat("en-IN",{maximumFractionDigits:0}).format(Math.round(v));}
function calculateEMI(p,a,m){if(p<=0||m<=0){return{emi:0,totalPayment:0,totalInterest:0};}var r=a/12/100;if(r===0){var e=p/m;return{emi:e,totalPayment:e*m,totalInterest:0};}var f=Math.pow(1+r,m);var emi=(p*r*f)/(f-1);var tp=emi*m;return{emi:emi,totalPayment:tp,totalInterest:tp-p};}
function update(scope){var ai=scope.querySelector("#loanAmount");var ri=scope.querySelector("#interestRate");var ti=scope.querySelector("#tenureMonths");if(!ai||!ri||!ti)return;var a=toNumber(ai.value);var r=toNumber(ri.value);var t=Math.max(1,Math.round(toNumber(ti.value)));var res=calculateEMI(a,r,t);var ao=scope.querySelector("#loanAmountOutput");var ro=scope.querySelector("#interestRateOutput");var to=scope.querySelector("#tenureOutput");var eo=scope.querySelector("#emiOutput");var io=scope.querySelector("#totalInterestOutput");var po=scope.querySelector("#totalPaymentOutput");if(ao)ao.textContent="Rs "+formatINR(a);if(ro)ro.textContent=r.toFixed(2)+"%";if(to)to.textContent=t+" months";if(eo)eo.textContent="Rs "+formatINR(res.emi);if(io)io.textContent="Rs "+formatINR(res.totalInterest);if(po)po.textContent="Rs "+formatINR(res.totalPayment);}
function bind(scope){scope.querySelectorAll("[data-preset]").forEach(function(b){b.addEventListener("click",function(){var ai=scope.querySelector("#loanAmount");var ri=scope.querySelector("#interestRate");var ti=scope.querySelector("#tenureMonths");if(!ai||!ri||!ti)return;var p=(b.getAttribute("data-preset")||"").split("|");if(p[0])ai.value=p[0];if(p[1])ri.value=p[1];if(p[2])ti.value=p[2];update(scope);});});}
document.addEventListener("DOMContentLoaded",function(){var scope=document.querySelector("[data-emi-calculator]");if(!scope)return;["#loanAmount","#interestRate","#tenureMonths"].forEach(function(s){var f=scope.querySelector(s);if(f){f.addEventListener("input",function(){update(scope);});}});bind(scope);update(scope);});
})();
